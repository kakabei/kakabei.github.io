I"Ï<<p>1ã€<code class="language-plaintext highlighter-rouge">string.h</code> å’Œ<code class="language-plaintext highlighter-rouge">cstring</code> éƒ½ä¸æ˜¯stringç±»çš„å¤´æ–‡ä»¶ï¼Œè¿™ä¸¤ä¸ªå¤´æ–‡ä»¶ä¸»è¦åœ°å®šä¹‰Cè¯­è¨€å­—ç¬¦æ“ä½œçš„ä¸€äº›æ–¹æ³• ï¼Œè­¬å¦‚<code class="language-plaintext highlighter-rouge">strlen()</code>ã€<code class="language-plaintext highlighter-rouge">strcpy()</code> ç­‰ã€‚<code class="language-plaintext highlighter-rouge">string.h</code> æ˜¯Cè¯­è¨€çš„å¤´æ–‡ä»¶æ ¼å¼ï¼Œè€Œ <code class="language-plaintext highlighter-rouge">cstring</code> æ˜¯C++é£æ ¼çš„å¤´æ–‡ä»¶ï¼Œä½†æ˜¯å’Œ <code class="language-plaintext highlighter-rouge">&lt;string.h&gt;</code> æ˜¯ä¸€æ ·çš„ï¼Œå®ƒçš„ç›®çš„æ˜¯ä¸ºäº†å’Œ C è¯­è¨€å…¼å®¹ã€‚</p>

<p>2ã€<code class="language-plaintext highlighter-rouge">string</code> çš„ä¸€é“é¢è¯•é¢˜ã€‚ç¼–å†™ä¸€ä¸ªç±» <code class="language-plaintext highlighter-rouge">string</code> çš„å‡ ä¸ªå‡½æ•°ã€‚ï¼ˆè§åé¢ï¼‰</p>

<p>3ã€C++ å­—ç¬¦ä¸²å’Œ C å­—ç¬¦ä¸²çš„è½¬æ¢ã€‚</p>

<p>C++ æä¾›äº†çš„ç”± C++å­—ç¬¦ä¸²è½¬æ¢æˆå¯¹åº”çš„Cå­—ç¬¦ä¸²çš„æ–¹æ³•æ˜¯ä½¿ç”¨ <code class="language-plaintext highlighter-rouge">data()</code>ã€<code class="language-plaintext highlighter-rouge">c_str()</code>å’Œ <code class="language-plaintext highlighter-rouge">copy()</code>æ¥å®ç°ã€‚</p>

<p>å…¶ä¸­ï¼Œ<code class="language-plaintext highlighter-rouge">data()</code> ä»¥å­—ç¬¦æ•°æ®çš„å½¢å¼è¿”å›å­—ç¬¦ä¸²å†…å®¹ï¼Œä½†å¹¶ä¸æ·»åŠ  <code class="language-plaintext highlighter-rouge">'\0'</code>ï¼›<code class="language-plaintext highlighter-rouge">c_str()</code> è¿”å›ä¸€ä»¥<code class="language-plaintext highlighter-rouge">'\0'</code>ç»“å°¾çš„å­—ç¬¦æ•°ç»„ï¼›è€Œ <code class="language-plaintext highlighter-rouge">copy()</code> åˆ™æŠŠå­—ç¬¦ä¸²çš„å†…å®¹å¤åˆ¶æˆ–å†™å…¥æ—¢æœ‰çš„ <code class="language-plaintext highlighter-rouge">c_string</code> æˆ–å­—ç¬¦æ•°ç»„å†…ï¼Œéœ€è¦æ³¨æ„æ˜¯ï¼Œc++ å­—ç¬¦ä¸²å¹¶ä»¥ä¸<code class="language-plaintext highlighter-rouge">'\0'</code>ç»“å°¾ã€‚</p>

<p><code class="language-plaintext highlighter-rouge">c_str()</code>è¯­å¥å¯ä»¥ç”Ÿæˆä¸€ä¸ª <code class="language-plaintext highlighter-rouge">const char *</code>  æŒ‡é’ˆï¼ŒæŒ‡å‘ç©ºå­—ç¬¦çš„æ•°ç»„ã€‚è¿™ä¸ªæ•°ç»„çš„æ•°æ®æ˜¯ä¸´æ—¶çš„ï¼Œ å½“æœ‰ä¸€ä¸ªæ”¹å˜è¿™æ•°æ®çš„æˆå‘˜å‡½æ•°è¢«è°ƒç”¨åï¼Œå…¶ä¸­çš„æ•°æ®å°±ä¼šå¤±æ•ˆã€‚å› æ­¤è¦ä¹ˆç°ç”¨ç°è½¬æ¢ï¼Œè¦ä¹ˆæŠŠå®ƒçš„æ•°æ®å¤åˆ¶åˆ°ç”¨æˆ·è‡ªå·±å¯ä»¥ç®¡ç†çš„å†…åœ¨ä¸­åå†è½¬æ¢ã€‚</p>

<p>4ã€<code class="language-plaintext highlighter-rouge">string</code> å’Œ <code class="language-plaintext highlighter-rouge">int</code> çš„ç±»å‹è½¬æ¢</p>

<p>ï¼ˆ1ï¼‰ <code class="language-plaintext highlighter-rouge">int</code> è½¬ <code class="language-plaintext highlighter-rouge">string</code> çš„æ–¹æ³•ã€‚</p>

<p>å¯ä»¥ç”¨ <code class="language-plaintext highlighter-rouge">snprintf()</code>ã€‚</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="n">snprintf</span><span class="p">(</span><span class="kt">char</span> <span class="o">*</span><span class="n">str</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">size</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">format</span><span class="p">,</span> <span class="p">...)</span>
</code></pre></div></div>
<p>ï¼ˆ2ï¼‰<code class="language-plaintext highlighter-rouge">string</code> è½¬ <code class="language-plaintext highlighter-rouge">int</code>çš„æ–¹æ³•</p>

<p>å¯ä»¥ç”¨ <code class="language-plaintext highlighter-rouge">strtol</code>ï¼Œ <code class="language-plaintext highlighter-rouge">strtoll</code>ï¼Œ<code class="language-plaintext highlighter-rouge">strtoul</code>ï¼Œæˆ– <code class="language-plaintext highlighter-rouge">strtoull</code>å‡½æ•°ã€‚</p>

<p>5ã€<code class="language-plaintext highlighter-rouge">string</code> å…¶ä»–å¸¸ç”¨æˆå‘˜å‡½æ•°</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kt">int</span> <span class="n">capacity</span><span class="p">()</span> <span class="k">const</span> <span class="p">;</span>             <span class="c1">// è¿”å›å½“å‰å®¹é‡ï¼ˆå³string ä¸­ä¸å¿…å¢åŠ å†…åœ¨å³å¯å­˜çš„å…ƒç´ ä¸ªæ•°ï¼‰</span>
<span class="kt">int</span> <span class="n">max_size</span><span class="p">()</span><span class="k">const</span><span class="p">;</span>               <span class="c1">// è¿”å›stringå¯¹è±¡ä¸­å¯å­˜æ”¾çš„æœ€å¤§å­—ç¬¦ä¸²çš„é•¿åº¦</span>
<span class="kt">int</span> <span class="n">size</span><span class="p">()</span> <span class="k">const</span> <span class="p">;</span>                 <span class="c1">// è¿”å›å½“å‰å­—ç¬¦ä¸²çš„å¤§å° </span>
<span class="kt">int</span> <span class="n">length</span><span class="p">()</span> <span class="k">const</span><span class="p">;</span>                <span class="c1">// è¿”å›å½“å‰å­—ç¬¦ä¸²çš„é•¿åº¦</span>
<span class="kt">int</span> <span class="n">empty</span><span class="p">()</span> <span class="k">const</span><span class="p">;</span>                 <span class="c1">// å½“å‰å­—ç¬¦ä¸²æ˜¯å¦ä¸ºç©º</span>
<span class="kt">void</span> <span class="nf">resize</span><span class="p">(</span><span class="kt">int</span> <span class="n">len</span><span class="p">,</span> <span class="kt">char</span> <span class="n">c</span><span class="p">)</span> <span class="p">;</span>      <span class="c1">// æŠŠå­—ç¬¦ä¸²å½“å‰å¤§å°ä¸ºä¸ºlenï¼Œå¹¶ç”¨å­—ç¬¦cå¡«å……ä¸è¶³çš„éƒ¨åˆ†ã€‚</span>
</code></pre></div></div>

<p>6ã€<code class="language-plaintext highlighter-rouge">string</code> çš„<code class="language-plaintext highlighter-rouge">size()</code>å’Œ<code class="language-plaintext highlighter-rouge">length()</code>çš„ç»“æœæ˜¯ä¸€æ ·çš„ã€‚</p>

<p><code class="language-plaintext highlighter-rouge">length</code> æ˜¯å› ä¸ºæ²¿ç”¨ C è¯­è¨€çš„ä¹ æƒ¯è€Œä¿ç•™ä¸‹æ¥çš„ï¼Œ<code class="language-plaintext highlighter-rouge">string</code> ç±»æœ€åˆåªæœ‰ <code class="language-plaintext highlighter-rouge">length</code>ï¼Œå¼•å…¥ STL ä¹‹åï¼Œä¸ºäº†å…¼å®¹åˆåŠ å…¥äº† <code class="language-plaintext highlighter-rouge">size</code>ï¼Œå®ƒæ˜¯ä½œä¸º STL å®¹å™¨çš„å±æ€§å­˜åœ¨çš„ï¼Œä¾¿äºç¬¦åˆ STL çš„æ¥å£è§„åˆ™ï¼Œä»¥ä¾¿ç”¨äº STL çš„ç®—æ³•ã€‚<code class="language-plaintext highlighter-rouge">string</code> ç±»çš„ <code class="language-plaintext highlighter-rouge">size()/length()</code>æ–¹æ³•è¿”å›çš„æ˜¯å­—èŠ‚æ•°ï¼Œä¸ç®¡æ˜¯å¦æœ‰æ±‰å­—ã€‚</p>

<div class="language-c++ highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">String</span> 
<span class="p">{</span> 
<span class="nl">public:</span> 
   <span class="n">String</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">str</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">);</span>  <span class="c1">// æ™®é€šæ„é€ å‡½æ•° </span>
   <span class="n">String</span><span class="p">(</span><span class="k">const</span> <span class="n">String</span> <span class="o">&amp;</span><span class="n">other</span><span class="p">);</span>     <span class="c1">// æ‹·è´æ„é€ å‡½æ•° </span>
   <span class="n">String</span><span class="p">(</span><span class="n">String</span> <span class="o">&amp;&amp;</span><span class="n">other</span><span class="p">);</span>          <span class="c1">// ç§»åŠ¨æ„é€ å‡½æ•° </span>
   <span class="o">~</span> <span class="n">String</span><span class="p">(</span><span class="kt">void</span><span class="p">);</span>                  <span class="c1">// ææ„å‡½æ•° </span>
   <span class="n">String</span> <span class="o">&amp;</span> <span class="n">operate</span> <span class="o">=</span><span class="p">(</span><span class="k">const</span> <span class="n">String</span> <span class="o">&amp;</span><span class="n">other</span><span class="p">);</span> <span class="c1">// èµ‹å€¼å‡½æ•° </span>
   <span class="n">String</span> <span class="o">&amp;</span> <span class="n">operate</span> <span class="o">=</span> <span class="p">(</span><span class="n">String</span> <span class="o">&amp;&amp;</span><span class="n">other</span><span class="p">);</span>      <span class="c1">// ç§»åŠ¨èµ‹å€¼å‡½æ•° </span>
<span class="nl">private:</span> 
   <span class="kt">char</span> <span class="o">*</span><span class="n">m_data</span><span class="p">;</span> <span class="c1">// ç”¨äºä¿å­˜å­—ç¬¦ä¸² </span>
<span class="p">};</span>

<span class="c1">// String çš„æ™®é€šæ„é€ å‡½æ•°</span>
<span class="n">String</span><span class="o">::</span><span class="n">String</span><span class="p">(</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">str</span><span class="p">)</span> 
<span class="p">{</span> 
   <span class="k">if</span><span class="p">(</span><span class="n">str</span><span class="o">==</span><span class="nb">NULL</span><span class="p">)</span> 
   <span class="p">{</span> 
      <span class="n">m_data</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">char</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span> 
      <span class="o">*</span><span class="n">m_data</span> <span class="o">=</span> <span class="err">â€˜\</span><span class="mi">0</span><span class="err">â€™</span><span class="p">;</span> 
   <span class="p">}</span> 
   <span class="k">else</span> 
   <span class="p">{</span> 
      <span class="kt">int</span> <span class="n">length</span> <span class="o">=</span> <span class="n">strlen</span><span class="p">(</span><span class="n">str</span><span class="p">);</span> 
      <span class="n">m_data</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">char</span><span class="p">[</span><span class="n">length</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span> 
      <span class="n">strcpy</span><span class="p">(</span><span class="n">m_data</span><span class="p">,</span> <span class="n">str</span><span class="p">);</span> 

   <span class="p">}</span> 
<span class="p">}</span>

<span class="c1">// String ç§»åŠ¨æ„é€ å‡½æ•°</span>
<span class="n">String</span><span class="o">::</span><span class="n">String</span><span class="p">(</span><span class="n">String</span> <span class="o">&amp;&amp;</span><span class="n">other</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">m_data</span> <span class="o">=</span> <span class="n">other</span><span class="p">.</span><span class="n">m_data</span><span class="p">;</span> 
    <span class="n">other</span><span class="p">.</span><span class="n">m_data</span> <span class="o">=</span> <span class="nb">nullptr</span><span class="p">;</span> 
<span class="p">}</span>

<span class="c1">// String çš„ææ„å‡½æ•°</span>
 <span class="n">String</span><span class="o">::~</span><span class="n">String</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> 
<span class="p">{</span> 
   <span class="k">delete</span> <span class="p">[]</span> <span class="n">m_data</span><span class="p">;</span> <span class="c1">// ç”±äº m_data æ˜¯å†…éƒ¨æ•°æ®ç±»å‹ï¼Œä¹Ÿå¯ä»¥å†™æˆ delete m_data; </span>
 <span class="p">}</span>

<span class="c1">// æ‹·è´æ„é€ å‡½æ•° </span>
<span class="n">String</span><span class="o">::</span><span class="n">String</span><span class="p">(</span><span class="k">const</span> <span class="n">String</span> <span class="o">&amp;</span><span class="n">other</span><span class="p">)</span> 
<span class="p">{</span> 
    <span class="c1">// å…è®¸æ“ä½œ other çš„ç§æœ‰æˆå‘˜ m_data </span>
   <span class="kt">int</span> <span class="n">length</span> <span class="o">=</span> <span class="n">strlen</span><span class="p">(</span><span class="n">other</span><span class="p">.</span><span class="n">m_data</span><span class="p">);</span> 
   <span class="n">m_data</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">char</span><span class="p">[</span><span class="n">length</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span> 
   <span class="n">strcpy</span><span class="p">(</span><span class="n">m_data</span><span class="p">,</span> <span class="n">other</span><span class="p">.</span><span class="n">m_data</span><span class="p">);</span> 
<span class="p">}</span>

<span class="c1">// èµ‹å€¼å‡½æ•° </span>
<span class="n">String</span> <span class="o">&amp;</span> <span class="n">String</span><span class="o">::</span><span class="n">operate</span> <span class="o">=</span><span class="p">(</span><span class="k">const</span> <span class="n">String</span> <span class="o">&amp;</span><span class="n">other</span><span class="p">)</span> 
<span class="p">{</span> 
   <span class="c1">// æ£€æŸ¥è‡ªèµ‹å€¼ </span>
   <span class="k">if</span><span class="p">(</span><span class="k">this</span> <span class="o">==</span> <span class="o">&amp;</span><span class="n">other</span><span class="p">)</span> 
   <span class="k">return</span> <span class="o">*</span><span class="k">this</span><span class="p">;</span> 
 
   <span class="c1">// é‡Šæ”¾åŸæœ‰çš„å†…å­˜èµ„æº </span>
   <span class="k">delete</span> <span class="p">[]</span> <span class="n">m_data</span><span class="p">;</span> 
 
   <span class="c1">// åˆ†é…æ–°çš„å†…å­˜èµ„æºï¼Œå¹¶å¤åˆ¶å†…å®¹ </span>
   <span class="kt">int</span> <span class="n">length</span> <span class="o">=</span> <span class="n">strlen</span><span class="p">(</span><span class="n">other</span><span class="p">.</span><span class="n">m_data</span><span class="p">);</span> 
   <span class="n">m_data</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">char</span><span class="p">[</span><span class="n">length</span><span class="o">+</span><span class="mi">1</span><span class="p">];</span> 
   <span class="n">strcpy</span><span class="p">(</span><span class="n">m_data</span><span class="p">,</span> <span class="n">other</span><span class="p">.</span><span class="n">m_data</span><span class="p">);</span> 
 
   <span class="c1">// è¿”å›æœ¬å¯¹è±¡çš„å¼•ç”¨ </span>
   <span class="k">return</span> <span class="o">*</span><span class="k">this</span><span class="p">;</span> 
<span class="p">}</span>

<span class="c1">// ç§»åŠ¨èµ‹å€¼å‡½æ•° </span>
<span class="n">String</span> <span class="o">&amp;</span> <span class="n">String</span><span class="o">::</span><span class="n">operate</span> <span class="o">=</span> <span class="p">(</span><span class="n">String</span> <span class="o">&amp;&amp;</span><span class="n">other</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">this</span> <span class="o">!=</span> <span class="n">other</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">delete</span><span class="p">[]</span> <span class="n">m_data</span><span class="p">;</span> 
        <span class="n">m_data</span> <span class="o">=</span> <span class="n">other</span><span class="p">.</span><span class="n">m_data</span><span class="p">;</span> 
        <span class="n">other</span><span class="p">.</span><span class="n">m_data</span> <span class="o">=</span> <span class="nb">nullptr</span><span class="p">;</span> 
    <span class="p">}</span>
    <span class="k">return</span> <span class="o">*</span><span class="k">this</span><span class="p">;</span> 
<span class="p">}</span>
</code></pre></div></div>

:ET