---
layout: post
title: mysql 体系构架
date: 2015-05-23 11:08:12
categories: db
tags:  mysql 
excerpt: InnoDB 引擎是 mysql 的默认引擎。
---



# 一、体系框架

mysql 的体系构架划分为：1）网络接入层；2）服务层；3）存储引擎层；4）文件系统。

1、 **网络接入层** 

提供了应用程序接入 mysql 服务的接口。 客户端与服务端建立连接。

2、**服务层**  

包含了 **管理工具和服务**、**连接池**、**SQL接口**、**查询解析器**、**查询优化器**、**缓存**

	- 管理工具和服务： 系统管理和控制工具，例如备份恢复、Mysql复制、集群等
	- 主要负责连接管理、授权认证、安全等等。
	- 接受SQL命令： 验证和解析 SQL命令。
	- 查询优化器： SQL语句在查询之前会使用查询优化器对查询进行优化。
	- 缓存：查询缓存有命中的查询结果，查询语句就可以直接去查询缓存中取数据。

3、**存储引擎层** 

负责数据的存储和读取，与数据库文件打交道。 服务器中的查询执行引擎通过API与存储引擎进行通信，通过接口屏蔽了不同存储引擎之间的差异。

MySQL采用插件式的存储引擎。MySQL为我们提供了许多存储引擎，每种存储引擎有不同的特点。我们可以根据不同的业务特点，选择最适合的存储引擎。

MySQL区别于其他数据库的最重要的一个特点就是插件式的表存储引擎，注意：存储引擎是基于表的。

4、 **文件系统**

主要是将数据库的数据存储在文件系统之上，并完成与存储引擎的交互。

# 二、一个SQL语句在MySQL中的整体流程

![](/assets/db/mysql-2022-09-26_13-52-18.png)


# 三、存储引擎

存储引擎主要是通过不同的**存储机制**、**索引技巧**、**锁定水平**提供琐的功能和能力。 

MySQL区别于其他数据库的最重要的一个特点就是插件式的表存储引擎，也就是说存储引擎是基于表的。

存储引擎的概念是MySQL里面才有的，不是所有的关系型数据库都有存储引擎这个概念 。其它数据库系统 (包括大多数商业选择)仅支持一种类型的数据存储， 也就是说采用“ 一个尺码满足一切需求 ”的存储方式，也意味着“功能强大，性能平庸”。而MySQL默认配置了许多不同的存储引擎，你可以根据业务需求选取一种最适配最高效的存储引擎。这也是为什么MySQL为何如此受欢迎的主要原因之一。


## 3.1 存储引擎分类

查看当前安装的MySQL版本支持的存储引擎

```mysql 
-- 查看MySQL版本
select version();

-- 查看版本支持的存储引擎
show engines;
```

(补上图)


**10种存储引擎**：

1、MyISAM： 拥有较高的插入，查询速度，但不支持事务。

2、 InnoDB ：5.5.8版本后Mysql的默认数据库引擎，支持ACID事务，支持行级锁定。

3、BDB： 源自Berkeley DB，事务型数据库的另一种选择，支持COMMIT和ROLLBACK等其他事务特性。

4、Memory ：所有数据置于内存的存储引擎，拥有极高的插入，更新和查询效率。但是会占用和数据量成正比的内存空间。并且其内容会在Mysql重新启动时丢失。

5、Merge ：将一定数量的MyISAM表联合而成一个整体，在超大规模数据存储时很有用。

6、Archive ：非常适合存储大量的独立的，作为历史记录的数据。因为它们不经常被读取。Archive拥有高效的插入速度，但其对查询的支持相对较差。

7、Federated： 将不同的Mysql服务器联合起来，逻辑上组成一个完整的数据库。非常适合分布式应用。

8、Cluster/NDB ：高冗余的存储引擎，用多台数据机器联合提供服务以提高整体性能和安全性。适合数据量大，安全和性能要求高的应用。

9、CSV： 逻辑上由逗号分割数据的存储引擎。它会在数据库子目录里为每个数据表创建一个.CSV文件。这是一种普通文本文件，每个数据行占用一个文本行。CSV存储引擎不支持索引。

10、BlackHole ：黑洞引擎，写入的任何数据都会消失，一般用于记录binlog做复制的中继。

这一些引擎的区别可以查看官网：[Chapter 15 Alternative Storage Engines](https://dev.mysql.com/doc/refman/5.7/en/storage-engines.html)

一般被问的比较的多的是 MyISAM 和 InnoDB 这两种的区别：

1、InnoDB 支持事务，MyISAM 不支持事务。

2、InnoDB 支持外键，而 MyISAM 不支持。

3、InnoDB 不保存表的具体行数，执行 `select count(*) from table` 时需要全表扫描。而MyISAM 用一个变量保存了整个表的行数，执行上述语句时只需要读出该变量即可，速度很快。

4、InnoDB 是聚集索引，MyISAM 是非聚集索引。

5、InnoDB 最小的锁粒度是行锁，MyISAM 最小的锁粒度是表锁。

6、InnoDB更消耗资源，读取速度没有MyISAM快。



----

1、[MySQL体系构架、存储引擎和索引结构](https://zhuanlan.zhihu.com/p/500250022)

2、[https://www.cnblogs.com/klvchen/articles/12809342.html](https://www.cnblogs.com/klvchen/articles/12809342.html)

3、[Mysql 中 MyISAM 和 InnoDB 的区别有哪些？](https://www.zhihu.com/question/20596402/answer/211492971)

4、高性能MySQL(第2版)中文版.pdf

